--- /usr/portage/sys-apps/dbus/dbus-1.3.0-r2.ebuild	2010-08-05 14:54:03.000000000 -0500
+++ ./sys-apps/dbus/dbus-1.3.0-r2.ebuild	2010-08-06 06:54:51.385098949 -0500
@@ -27,10 +27,6 @@
 		app-text/xmlto
 		app-text/docbook-xml-dtd:4.1.2 )"
 
-# out of sources build directory
-BD=${WORKDIR}/${P}-build
-# out of sources build dir for make check
-TBD=${WORKDIR}/${P}-tests-build
 
 pkg_setup() {
 	enewgroup messagebus
@@ -52,6 +48,11 @@
 }
 
 src_configure() {
+	# out of sources build directory
+	BD=${WORKDIR}/${P}-build
+	# out of sources build dir for make check
+	TBD=${WORKDIR}/${P}-tests-build
+
 	local my_conf
 
 	# libaudit is *only* used in DBus wrt SELinux support, so disable it, if
@@ -90,6 +91,11 @@
 }
 
 src_compile() {
+	# out of sources build directory
+	BD=${WORKDIR}/${P}-build
+	# out of sources build dir for make check
+	TBD=${WORKDIR}/${P}-tests-build
+
 	# after the compile, it uses a selinuxfs interface to
 	# check if the SELinux policy has the right support
 	use selinux && addwrite /selinux/access
@@ -111,11 +117,21 @@
 }
 
 src_test() {
+	# out of sources build directory
+	BD=${WORKDIR}/${P}-build
+	# out of sources build dir for make check
+	TBD=${WORKDIR}/${P}-tests-build
+
 	cd "${TBD}"
 	DBUS_VERBOSE=1 make check || die "make check failed"
 }
 
 src_install() {
+	# out of sources build directory
+	BD=${WORKDIR}/${P}-build
+	# out of sources build dir for make check
+	TBD=${WORKDIR}/${P}-tests-build
+
 	# initscript
 	newinitd "${FILESDIR}"/dbus.init-1.0 dbus
 
