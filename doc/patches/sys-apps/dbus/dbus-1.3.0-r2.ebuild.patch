--- /usr/portage/sys-apps/dbus/dbus-1.3.0-r2.ebuild	2010-03-31 04:36:03.000000000 +0200
+++ ./sys-apps/dbus/dbus-1.3.0-r2.ebuild	2010-04-03 17:58:15.000000000 +0200
@@ -27,11 +27,6 @@
 		app-text/xmlto
 		app-text/docbook-xml-dtd:4.1.2 )"
 
-# out of sources build directory
-BD=${WORKDIR}/${P}-build
-# out of sources build dir for make check
-TBD=${WORKDIR}/${P}-tests-build
-
 pkg_setup() {
 	enewgroup messagebus
 	enewuser messagebus -1 "-1" -1 messagebus
@@ -52,6 +47,11 @@
 }
 
 src_configure() {
+	# out of sources build directory
+	BD=${WORKDIR}/${P}-build-${ABI}
+	# out of sources build dir for make check
+	TBD=${WORKDIR}/${P}-tests-build-${ABI}
+
 	local my_conf
 
 	# libaudit is *only* used in DBus wrt SELinux support, so disable it, if
@@ -90,6 +90,11 @@
 }
 
 src_compile() {
+	# out of sources build directory
+	BD=${WORKDIR}/${P}-build-${ABI}
+	# out of sources build dir for make check
+	TBD=${WORKDIR}/${P}-tests-build-${ABI}
+
 	# after the compile, it uses a selinuxfs interface to
 	# check if the SELinux policy has the right support
 	use selinux && addwrite /selinux/access
@@ -111,11 +116,21 @@
 }
 
 src_test() {
+	# out of sources build directory
+	BD=${WORKDIR}/${P}-build-${ABI}
+	# out of sources build dir for make check
+	TBD=${WORKDIR}/${P}-tests-build-${ABI}
+
 	cd "${TBD}"
 	DBUS_VERBOSE=1 make check || die "make check failed"
 }
 
 src_install() {
+	# out of sources build directory
+	BD=${WORKDIR}/${P}-build-${ABI}
+	# out of sources build dir for make check
+	TBD=${WORKDIR}/${P}-tests-build-${ABI}
+
 	# initscript
 	newinitd "${FILESDIR}"/dbus.init-1.0 dbus
 
