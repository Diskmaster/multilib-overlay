--- /usr/portage/sys-apps/file/file-5.03.ebuild	2010-02-14 20:06:25.000000000 +0100
+++ ./sys-apps/file/file-5.03.ebuild	2010-04-04 13:22:08.000000000 +0200
@@ -23,8 +23,9 @@
 
 src_unpack() {
 	unpack ${P}.tar.gz
-	cd "${S}"
+}
 
+src_prepare() {
 	epatch "${FILESDIR}"/${PN}-4.15-libtool.patch #99593
 
 	elibtoolize
@@ -39,11 +40,14 @@
 #	sed -i '/^pkgdatadir/s:/@PACKAGE@::' $(find -name Makefile.in)
 }
 
-src_compile() {
+src_configure() {
 	# file uses things like strndup() and wcwidth()
 	append-flags -D_GNU_SOURCE
 
 	econf || die
+}
+
+src_compile() {
 	emake || die
 
 	use python && cd python && distutils_src_compile
