--- /auto/portage/dev-libs/glib/glib-1.2.10-r5.ebuild	2010-03-30 22:36:03.000000000 -0400
+++ ./dev-libs/glib/glib-1.2.10-r5.ebuild	2010-11-22 22:42:05.687130583 -0500
@@ -17,10 +17,8 @@
 
 DEPEND=""
 
-src_unpack() {
-	unpack ${A}
-	cd "${S}"
-
+src_prepare() {
+	
 	epatch "${FILESDIR}"/${P}-automake.patch
 	epatch "${FILESDIR}"/${P}-m4.patch
 	epatch "${FILESDIR}"/${P}-configure-LANG.patch #133679
@@ -31,6 +29,9 @@
 	# Fix for -Wl,--as-needed (bug #133818)
 	epatch "${DISTDIR}"/glib-1.2.10-r1-as-needed.patch.bz2
 
+	# Fix inline with gcc-4.3
+	epatch "${FILESDIR}"/${P}-gcc43-inline.patch
+	
 	use ppc64 && use hardened && replace-flags -O[2-3] -O1
 	append-ldflags $(dlopen_lib)
 
@@ -39,7 +40,7 @@
 	elibtoolize
 }
 
-src_compile() {
+src_configure() {
 	# Bug 48839: pam fails to build on ia64
 	# The problem is that it attempts to link a shared object against
 	# libglib.a; this library needs to be built with -fPIC.  Since
@@ -51,7 +52,6 @@
 		--with-threads=posix \
 		--enable-debug=yes \
 		|| die
-	emake || die
 }
 
 src_install() {
