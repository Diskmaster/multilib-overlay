--- /usr/portage/dev-libs/openssl/openssl-1.0.0a-r3.ebuild	2010-09-12 07:35:33.000000000 +0200
+++ ./dev-libs/openssl/openssl-1.0.0a-r3.ebuild	2010-09-12 13:38:53.000000000 +0200
@@ -26,8 +26,9 @@
 src_unpack() {
 	unpack ${P}.tar.gz
 	cp "${DISTDIR}"/openssl-c_rehash.sh* "${WORKDIR}"/c_rehash || die
-	cd "${S}"
+}
 
+src_prepare() {
 	epatch "${FILESDIR}"/${PN}-0.9.7e-gentoo.patch
 	epatch "${FILESDIR}"/${PN}-0.9.8l-binutils.patch #289130
 	epatch "${FILESDIR}"/${PN}-1.0.0a-ldflags.patch #327421
@@ -63,7 +64,7 @@
 	./config --test-sanity || die "I AM NOT SANE"
 }
 
-src_compile() {
+src_configure() {
 	unset APPS #197996
 	unset SCRIPTS #312551
 
@@ -118,7 +119,9 @@
 		-e "/^CFLAG/s:=.*:=${CFLAG} ${CFLAGS}:" \
 		-e "/^SHARED_LDFLAGS=/s:$: ${LDFLAGS}:" \
 		Makefile || die
+}
 
+src_compile() {
 	# depend is needed to use $confopts
 	# rehash is needed to prep the certs/ dir
 	emake -j1 depend || die "depend failed"
